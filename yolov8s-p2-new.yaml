# Ultralytics YOLO ğŸš€, AGPL-3.0 license
# YOLOv8n-p2 (P2-P4) Optimized
# ç§»é™¤ Backbone P5 å»¢å±¤ï¼Œä¸¦è£œå› Head çš„ PANet è·¯å¾‘

# Parameters
nc: 1 # set your classes
scales:
  # [depth, width, max_channels]
  s: [0.33, 0.5, 1024]

# Backbone (ç§»é™¤åŸæœ¬çš„ 7,8,9 å±¤)
backbone:
  - [-1, 1, Conv, [64, 3, 2]]  # 0-P1/2
  - [-1, 1, Conv, [128, 3, 2]] # 1-P2/4
  - [-1, 3, C2f, [128, True]]  # 2-P2/4
  - [-1, 1, Conv, [256, 3, 2]] # 3-P3/8
  - [-1, 6, C2f, [256, True]]  # 4-P3/8
  - [-1, 1, Conv, [512, 3, 2]] # 5-P4/16
  - [-1, 6, C2f, [512, True]]  # 6-P4/16
  - [-1, 1, SPPF, [512, 5]]    # 7 (å°‡ SPPF ç§»åˆ° P4 çµå°¾)

# Head
head:
  # --- Top-down (FPN) ---
  - [-1, 1, nn.Upsample, [None, 2, 'nearest']] # 8
  - [[-1, 4], 1, Concat, [1]] # cat backbone P3
  - [-1, 3, C2f, [256]] # 10 (P3)

  - [-1, 1, nn.Upsample, [None, 2, 'nearest']] # 11
  - [[-1, 2], 1, Concat, [1]] # cat backbone P2
  - [-1, 3, C2f, [128]] # 13 (P2 output)

  # --- Bottom-up (PAN) å»ºè­°åŠ å›é€™æ®µ ---
  - [-1, 1, Conv, [128, 3, 2]] # 14 (P2 -> P3)
  - [[-1, 10], 1, Concat, [1]] # cat head P3
  - [-1, 3, C2f, [256]] # 16 (P3 output)

  - [-1, 1, Conv, [256, 3, 2]] # 17 (P3 -> P4)
  - [[-1, 7], 1, Concat, [1]] # cat head P4 (æ³¨æ„é€£å› Layer 7)
  - [-1, 3, C2f, [512]] # 19 (P4 output)

  # Detect
  # é †åºï¼š[P2(13), P3(16), P4(19)]
  - [[13, 16, 19], 1, Detect, [nc]]